# 25日目

<!-- mtoc-start -->

- [1. ディレクトリ対応](#1-ディレクトリ対応)
- [2. ファイル読み込み](#2-ファイル読み込み)

<!-- mtoc-end -->

## 1. ディレクトリ対応

FAT のセクタの終了は 0xFFFF_FFF8 以上かどうかで確認しないといけないのに、
等しい場合を見逃したので修正した。

また、クラスタのセクタ数が1でない場合にファイルが見つからなくなる問題もあったため修正した。

## 2. ファイル読み込み

`Read`, `Write` トレイト使えばいいやろな～くらいに思ったけど、
よく考えたら `core` に `io` モジュールあったか怪しくなって調べたけど、
experimental やったし `Read`, `Write` はなかった。

[移そうとはしている](https://github.com/rust-lang/rust/issues/48331) っぽいけど、
まあ諦めて手で書きますか……。

教科書では `FileDescriptor::Read()` 内で `FileDescriptor.rd_cluster` の初期化をしていたが、
別にコンストラクタ内でいい気がしたのでそのように変更した。

教科書通りに実装しはしたけど、これ `fd` を決めてから実際に `FileDescriptor` を挿入するまでの間に
同じ処理が走ると競合すると思う。
大丈夫なんやろか。
